<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <title>Document</title>
</head>

<body class="bgorange">
    <div class="container">
        <h1>Search Movie</h1>
        <div class="container1">
            <h5>Title</h5>
            <input type="text" id="searchinpt">
        </div>
        <div class="container1">
            <h5>Type</h5>
            <input type="text" />
        </div>
        <button id="srchbtn" onclick="findMovie()">Search</button>
    </div>

    <div id="wrapper"></div>
    <div id="pagination"></div>

    <script>
        let searchBox = document.getElementById("searchinpt");
        let btn = document.getElementById("srchbtn");
        const wrapper = document.getElementById("wrapper");
        const pagination = document.getElementById("pagination");
        const field = ["Title", "Type", "Year", "imdbID"];


        let currentPage = 1;
        let totalPages = 0;

        function loadMovies(searchTerm,page) {
            const apikey = `https://www.omdbapi.com/?s=${searchTerm}&page=${page}&apikey=abfc33ca`;
            fetch(apikey)
                .then(resp => resp.json())
                .then(data => {
                    if (data.Response === "True") {
                        displayMovieList(data.Search);
                        totalPages = Math.ceil(data.totalResults / 10);
                        displayPagination();
                    } else {
                        console.log(data.Error);
                    }
                })
                .catch(error => {
                    console.error(error);
                });
        }

        function findMovie() {
            let searchWord = searchBox.value;
            loadMovies(searchWord);
        }

        //cedvel formasi

        //function displayMovieList(movies) {
        //    let kod = '';
        //    kod += `<tr>${field.reduce((k, f) => k += `<th>${f}</th>`, '')}</tr>`;
        //    movies.forEach(movie => {
        //        kod += `<tr>${field.reduce((k, f) => k += `<td>${movie[f]}</td>`, '')}</tr>`;
        //    });
        //    wrapper.innerHTML = `<table class="table table-hover">${kod}</table>`;
        //}


        function displayMovieList(movies) {
            let kod = '';
           movies.forEach(movie=> {
                kod +=`<div class="card m-1" style="width: 18rem;">
                            <img src="${movie.Poster}" class="card-img-top" alt="no photo">
                            <div class="card-body">
                              <h5 class="card-title">${movie.Title}</h5>
                            </div>
                            <ul class="list-group list-group-flush">
                                ${field.slice(1).reduce((k, f) => k += `<li class="list-group-item"><b>${f}: </b>${movie[f]}</li>`, '')}
                            </ul>
                        </div>`
           })
           wrapper.innerHTML = `<div class="row row-cols-1 row-cols-md-4 g-4 justify-content-center mx-2">${kod}</div>`
        }

        function displayPagination() {
            let kod = '';
            for (let i = 1; i <= totalPages; i++) {
                kod += `<button class="btn btn-primary mx-1" onclick="goToPage(${i})">${i}</button>`;
            }
            pagination.innerHTML = kod;
        }

        function goToPage(page) {
            currentPage = page;
            let searchWord = searchBox.value;
            loadMovies(searchWord, currentPage);
        }

        
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
    crossorigin="anonymous"></script>

</body>


</html>